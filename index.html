<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…·èº«æ™ºèƒ½ & è‡ªåŠ¨é©¾é©¶å†…å‚</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 0; }
        
        /* --- æ ¸å¿ƒå¸ƒå±€ï¼šGrid åŒæ  --- */
        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: grid; 
            grid-template-columns: 320px 1fr; /* å·¦ä¾§320pxå›ºå®šï¼Œå³ä¾§è‡ªé€‚åº” */
            gap: 25px; align-items: start;
        }

        /* --- å·¦ä¾§æ—¥æŠ¥æ  --- */
        .sidebar {
            background: #2c3e50; color: #ecf0f1; border-radius: 12px; padding: 25px;
            position: sticky; top: 20px; /* æ»šåŠ¨å¸é™„ */
            max-height: 90vh; overflow-y: auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .brief-content { line-height: 1.6; font-size: 0.95em; }
        .brief-content h3 { color: #3498db; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; margin-top: 20px; }
        .brief-content strong { color: #f1c40f; }
        .sidebar-loading { text-align: center; color: #bdc3c7; padding: 20px; }

        /* --- å³ä¾§æ–°é—»æµ --- */
        .main-content { min-width: 0; }
        
        .header { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .header h1 { margin: 0; color: #2c3e50; font-size: 1.8em; }

        .filters { display: flex; gap: 8px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-btn { background: white; border: 1px solid #ddd; padding: 6px 14px; border-radius: 20px; cursor: pointer; color: #666; transition: 0.2s; }
        .filter-btn.active { background: #3498db; color: white; border-color: #3498db; }

        .card { background: white; border-radius: 10px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); border: 1px solid #eef; cursor: pointer; transition: 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); border-color: #3498db; }
        
        .meta { display: flex; justify-content: space-between; font-size: 0.85em; color: #999; margin-bottom: 10px; }
        .tag { padding: 3px 8px; border-radius: 4px; font-weight: 500; }
        .tag-cn { background: #ecf5ff; color: #409eff; }
        .tag-en { background: #f3e5f5; color: #7b1fa2; }
        .tag-paper { background: #fdf6ec; color: #e6a23c; }

        .title { font-size: 1.15em; font-weight: 700; color: #333; margin-bottom: 10px; }
        .summary-box { background: #f8f9fa; padding: 10px 15px; border-radius: 6px; font-size: 0.95em; color: #555; border-left: 3px solid #3498db; }

        /* --- ç¿»é¡µ & è·³è½¬ --- */
        .pagination { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 30px; background: white; padding: 15px; border-radius: 12px; }
        .page-btn { background: #f4f4f5; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; }
        .page-btn:hover:not(:disabled) { background: #3498db; color: white; }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .jump-box { display: flex; align-items: center; gap: 5px; margin-left: 10px; border-left: 1px solid #ddd; padding-left: 15px; }
        .jump-input { width: 40px; padding: 6px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
        .jump-btn { background: #2c3e50; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; }

        /* å¼¹çª— */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: white; width: 90%; max-width: 600px; border-radius: 12px; padding: 25px; position: relative; }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: #999; }
        .read-btn { display: block; width: 100%; text-align: center; background: #2c3e50; color: white; padding: 12px; border-radius: 8px; text-decoration: none; margin-top: 20px; }

        @media (max-width: 768px) { .container { grid-template-columns: 1fr; } .sidebar { position: static; max-height: none; } }
    </style>
</head>
<body>

<div class="container">
    <aside class="sidebar">
        <div id="brief-container">
            <div class="sidebar-loading">æ­£åœ¨åŠ è½½ä»Šæ—¥å†…å‚...<br>è¯·ç¡®ä¿å·²è¿è¡ŒæŠ“å–è„šæœ¬</div>
        </div>
    </aside>

    <main class="main-content">
        <div class="header"><h1>ğŸ¤– å…·èº«æ™ºèƒ½ & è‡ªåŠ¨é©¾é©¶æƒ…æŠ¥</h1></div>
        
        <div class="filters">
            <button class="filter-btn active" onclick="filter('all')">å…¨éƒ¨</button>
            <button class="filter-btn" onclick="filter('Paper')">ğŸ“„ è®ºæ–‡</button>
            <button class="filter-btn" onclick="filter('å…·èº«æ™ºèƒ½')">ğŸ¦¾ å…·èº«æ™ºèƒ½</button>
            <button class="filter-btn" onclick="filter('è‡ªåŠ¨é©¾é©¶')">ğŸš— è‡ªåŠ¨é©¾é©¶</button>
        </div>

        <div id="list">åŠ è½½ä¸­...</div>

        <div class="pagination" id="pagination" style="display:none;">
            <button class="page-btn" id="prev" onclick="changePage(-1)">ä¸Šä¸€é¡µ</button>
            <span id="pageInfo">1 / 1</span>
            <button class="page-btn" id="next" onclick="changePage(1)">ä¸‹ä¸€é¡µ</button>
            
            <div class="jump-box">
                <input type="number" id="jumpInput" class="jump-input" placeholder="#">
                <button class="jump-btn" onclick="jumpToPage()">Go</button>
            </div>
        </div>
    </main>
</div>

<div class="modal-overlay" id="modal" onclick="document.getElementById('modal').style.display='none'">
    <div class="modal-content" onclick="event.stopPropagation()">
        <span class="close-btn" onclick="document.getElementById('modal').style.display='none'">&times;</span>
        <h3 id="m-title" style="margin-top:0"></h3>
        <div id="m-body" style="line-height:1.6; color:#444;"></div>
        <a id="m-link" href="#" target="_blank" class="read-btn">é˜…è¯»åŸæ–‡</a>
    </div>
</div>

<script>
    let allData=[], filteredData=[], curPage=1; const perPage=6;

    // 1. åŠ è½½æ–°é—»
    fetch('data.json?t='+Date.now()).then(r=>r.json()).then(data => {
        if(!data.length) { document.getElementById('list').innerHTML='æš‚æ— æ•°æ®'; return; }
        data.sort((a,b) => new Date(b.date)-new Date(a.date));
        allData = data; filter('all');
        document.getElementById('pagination').style.display='flex';
    }).catch(e=>console.log(e));

    // 2. åŠ è½½æ—¥æŠ¥ (daily_brief.json)
    fetch('daily_brief.json?t='+Date.now())
        .then(r => r.ok ? r.json() : Promise.reject())
        .then(data => {
            // ä½¿ç”¨ marked æŠŠ Markdown æ¸²æŸ“æˆ HTML
            const htmlContent = marked.parse(data.content);
            document.getElementById('brief-container').innerHTML = `
                <div class="brief-content">${htmlContent}</div>
            `;
        })
        .catch(() => {
            document.getElementById('brief-container').innerHTML = `<div class="sidebar-loading">ä»Šæ—¥ç»¼è¿°å°šæœªç”Ÿæˆã€‚<br>è¯·å» Actions è¿è¡Œä¸€æ¬¡ "æ¯æ—¥æŠ“å–"ã€‚</div>`;
        });

    function filter(tag) {
        document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
        event.target.classList.add('active');
        filteredData = tag==='all'?allData:allData.filter(i=>i.source.includes(tag)||(tag==='å…·èº«æ™ºèƒ½'&&i.source.includes('Embodied')));
        curPage=1; render();
    }

    function render() {
        const list = document.getElementById('list'); list.innerHTML='';
        const pageData = filteredData.slice((curPage-1)*perPage, curPage*perPage);
        if(!pageData.length) { list.innerHTML='<div style="text-align:center;padding:20px;color:#999">æš‚æ— å†…å®¹</div>'; return;}
        
        pageData.forEach(item => {
            let tagType = item.lang==='EN'?'tag-en':(item.source.includes('Paper')?'tag-paper':'tag-cn');
            const d = document.createElement('div'); d.className='card';
            d.onclick=()=>openModal(item);
            d.innerHTML = `
                <div class="meta"><span class="tag ${tagType}">${item.source}</span><span>${item.date}</span></div>
                <div class="title">${item.title}</div>
                <div class="summary-box">AI æ‘˜è¦ï¼š${item.summary||"ç”Ÿæˆä¸­..."}</div>
            `;
            list.appendChild(d);
        });
        updatePageInfo();
    }

    function updatePageInfo() {
        const total = Math.ceil(filteredData.length/perPage);
        document.getElementById('pageInfo').innerText = `${curPage} / ${total||1}`;
        document.getElementById('prev').disabled = curPage===1;
        document.getElementById('next').disabled = curPage===total||total===0;
    }

    function changePage(d) { curPage+=d; render(); window.scrollTo(0,0); }
    
    function jumpToPage() {
        const p = parseInt(document.getElementById('jumpInput').value);
        const total = Math.ceil(filteredData.length/perPage);
        if(p>=1 && p<=total) { curPage=p; render(); window.scrollTo(0,0); document.getElementById('jumpInput').value=''; }
        else alert('é¡µç æ— æ•ˆ');
    }

    function openModal(item) {
        document.getElementById('m-title').innerText=item.title;
        document.getElementById('m-body').innerText=item.summary||"æš‚æ— ";
        document.getElementById('m-link').href=item.link;
        document.getElementById('modal').style.display='flex';
    }
</script>
</body>
</html>
